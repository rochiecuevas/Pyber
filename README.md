# Analysis of Pyber ride-sharing statistics
## Overview
The data of Pyber ride-shares were made available for analyses. It is aimed that insights could be generated from which strategies could be formulated to increase revenue from fares.

## Getting started
This data was analysed using Python module Pandas to analyse data; and MatPlotLib and Seaborn to create graphs based on the statistics.

```python
%matplotlib inline
# Dependencies and Setup
import matplotlib.pyplot as plt
import pandas as pd
import seaborn
```

The data was sourced from two .csv files (`city_data.csv` and `ride_data.csv`). These files were merged into a dataframe.

```python
# File to Load (Remember to change these)
city_data_to_load = "city_data.csv"
ride_data_to_load = "ride_data.csv"

# Read the City and Ride Data
city_data = pd.read_csv(city_data_to_load)
ride_data = pd.read_csv(ride_data_to_load)

# Combine the data into a single dataset
ride_df = pd.merge(city_data, ride_data,on = "city")

# Display the data table for preview
ride_df.head()
```

## Data Analyses
### Pyber Reach
A summary dataframe was generated. It contained the number of cities where Pyber was operating in, their classifications, the number of drivers, and the number of rides.

```python
# Get the city types and the city names
city_type = ride_df["type"].unique()
city = ride_df["city"].unique()

# Get initial data about the cities
city_count = len(city) # number of cities
city_type_count = len(city_type) # number of city types

# create a groupby object to get summary data
city_grped = ride_df.groupby(["city","type"])

no_rides = city_grped["ride_id"].count() # number of rides per city
ride_count = no_rides.sum()

no_drivers = city_grped["driver_count"].mean() # number of drivers per city
driver_count = no_drivers.sum()

# Summary table
summary = pd.DataFrame({"No. of cities": [city_count],
                        "No. of city types": [city_type_count],
                        "No. of rides": [ride_count],
                        "No. of drivers": [driver_count]})
```

### Trends in Ride-Sharing Data
Finding trends in the data is made easier by visualising it in a plot. A bubble plot allows one to see three dimensions of data. In this study, the number of rides (y-axis) was plotted against average fare (x-axis). The third axis is the number of drivers; this is represented by the size of the bubbles.

```python
# Obtain variables for the bubble plot

ave_fare = round(city_grped["fare"].mean(),2) # average fare per city

# create new dataframe to contain the data extracted from the groupby object
w = pd.DataFrame({"no_rides": no_rides,
                  "ave_fare": ave_fare,
                  "no_drivers": no_drivers})

w1 = w.reset_index() # to access the grouping variables from the previous groupby
z = no_drivers

labels = list(w1["type"].unique()) # list of city types 

# Plot the bubble plot
fg = seaborn.FacetGrid(data=w1, hue='type', hue_order=labels, aspect = 2)

fg1= fg.map(plt.scatter,"ave_fare", "no_rides",
            s = 5 * z, alpha = 0.5, edgecolor = "grey")

plt.xlabel("Average fare (USD)")
plt.ylabel("Number of rides")
plt.legend() # insert legend
plt.gcf().text(1, 0.6, "Bubble sizes are associated \nwith the number of drivers.", fontsize=12) # annotation
```

### Data distributions
Four pie charts were then generated to visualise various distributions of Pyber statistics:

1. city type
    To get the number of cities per city type, a dataframe containing a count of fares was generated. This data was then
    grouped by city type and then counted.
    
    ```python
    # Group the cities based on type
    t = city_grped["fare"].count()
    t1 = t.groupby("type")
    city_dist = t1.count()
    ```
    
2. total fare by city type
    To get the total fares, a dataframe containing the sum of fares (per city and city type) was generated. This was then 
    grouped by city type. The fares of each city type and their proportions relative to the total fare were calculated.
    
    ```python# Calculate Type Percents
    tot_fare = city_grped["fare"].sum()
    tot_fare1 = tot_fare.reset_index()

    tot_fare_gb = tot_fare1.groupby("type")
    tot_fare = tot_fare_gb.sum() # sum of fares

    pct_fare = round(((tot_fare_gb.sum()/tot_fare_gb.sum().sum()) * 100),2)

    print(pct_fare)
    ```
    
3. total rides by city type
    The number of rides per city type was generated by using grouping the data by city type and then calculating the sum.
    
    ```python
    # Calculate Ride Totals
    no_rides1 = no_rides.reset_index()
    rides_grped = no_rides1.groupby("type")
    tot_ride = rides_grped.sum()
    print(tot_ride)
    ```
    
4. total drivers by city type
    The number of drivers per city type was generated by using grouping the data by city type and then calculating the sum.
    
    ```python
    # Calculate Driver Totals
    no_drivers1 = no_drivers.reset_index()
    driver_grped = no_drivers1.groupby("type")
    tot_driver = driver_grped.sum()
    print(tot_driver)
    ```
Building the pie charts then involved changing `x` in the formula below with the variable for visualisation (`city_dis`, `tot_ride`, `tot_ride`, and `tot_driver`).

```python
# Build Pie Charts
plt.pie(x, labels = type_list, explode = explode, startangle = 90, shadow = True, autopct = "%1.1f%%")
plt.axis("equal")
```